%% Init goals
%  Sets up goal trajectories for controller to use.

%% Discrete goals
%  Get starting position from Baxter's current position
states = ones(16,1)*-1000;
bax_sub = rossubscriber('/robot/joint_states', rostype.sensor_msgs_JointState);
%  Get updates for all joints
msg = receive(bax_sub);
states = joint_states(msg,length(msg.Position),states);
while (min(states) < -500)
    % Get another message
    msg = receive(bax_sub);
    % Get states from it
	states = joint_states(msg);
end
initial_position = [0 states'];

%% Goals
%  Setup your goals and interpolate positions here
goals = [ 0 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498  0.099 -0.976  1.163 1.926 -0.708  0.999  0.551 0.02 0.02;  % Home
 4 -0.221 -0.511  0.071  2.180 -0.364 -1.391 -0.105  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.02 0.02;  % Left move away
 8  0.145 -0.079  0.226  1.285 -2.135 -1.441  0.426  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.02 0.02;  % Left approach
10  0.274  0.083  0.481  1.134 -2.304 -1.338  0.499  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.02 0.02;  % Left grab position
12  0.274  0.083  0.481  1.134 -2.304 -1.338  0.499  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.01 0.02;  % Left grab
17  0.145 -0.079  0.226  1.285 -2.135 -1.441  0.426  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.01 0.02;  % Left approach
22 -0.478 -0.318 -0.076  1.657  1.774 -1.562 -0.400  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.01 0.02;  % Left approach trade
24 -0.602 -0.397 -0.057  1.735  1.735 -1.468 -0.412  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.01 0.02;  % Trade position
25 -0.602 -0.397 -0.057  1.735  1.735 -1.468 -0.412  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.01 0.01;  % Right grab
26 -0.602 -0.397 -0.057  1.735  1.735 -1.468 -0.412  0.262 -0.368  0.245 1.955 -1.730 -1.246  0.073 0.02 0.01;  % Left release
28 -0.478 -0.318 -0.076  1.657  1.774 -1.562 -0.400  0.165 -0.443  0.185 2.014 -1.728 -1.243  0.088 0.02 0.01;  % Back off
32 -0.653 -0.835 -0.030  2.001  0.720 -0.084 -0.331  0.233 -0.390  0.061 1.993  1.117 -1.516 -0.041 0.02 0.01;  % Right move, left go home
36 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498 -0.041 -0.279 -0.160 2.078  1.600 -1.226  0.221 0.02 0.01;  % Right approach, left home
38 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498 -0.057 -0.066 -0.330 1.842  1.632 -1.050  0.096 0.02 0.01;  % Right drop position
39 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498 -0.057 -0.066 -0.330 1.842  1.632 -1.050  0.096 0.02 0.02;  % Right drop  % w2 was -1.096
42 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498 -0.041 -0.279 -0.160 2.078  1.600 -1.226  0.221 0.02 0.02;  % Right retreat
46 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498  0.822 -0.744 -0.330 2.060  0.246  0.130 -0.155 0.02 0.02;  % Right go home
50 -0.082 -0.999 -1.188  1.939  0.669  1.028 -0.498  0.099 -0.976  1.163 1.926 -0.708  0.999  0.551 0.02 0.02;  % Home
    ];
